<html>
<head>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"> </script>
<script type="text/javascript" src="../js/ConstructUrls.js"></script>
<script type="text/javascript">
const url = window.location.href;
const getUrl = url.substring(url.indexOf("?")+1);
String.prototype.replaceAll = function(target, replacement) {
			return this.split(target).join(replacement);
		};

function initPrint(){
$.ajax({
						url: getUrl,
						async: false,
						cache:false,
						dataType: "text",
						type: 'GET',
						success : function(data){
							console.log("done");
							var iframe = document.createElement('iframe');
							iframe.id='printFrame';
						    iframe.style.width = "100%";
						    iframe.style.height = "100%";
							iframe.scrolling= 'no';	
						    iframe.style.border="0";
						    data = data.replace('</head>', '<style>.contentPlaceholder{background-color:#efefef;border-width: 1px;border-color: #999999;font-size: 15pt;color:#b3b3b3;text-align: center;display: table-cell;vertical-align: middle;}@media print{#pagelogo{display:block;}.iframe-table{border:none !important;}#watermark {display:block;color: #d0d0d0;font-size: 75pt;-webkit-transform: rotate(-45deg);-moz-transform: rotate(-45deg);transform: rotate(-45deg);position: fixed;width: 100%;height: 100%;xmargin: 0;z-index: 100;opacity: 0.6;left: 46%;top:25%;text-align: center;}thead{display:table-header-group;text-align:left;}tfoot{display:table-footer-group;text-align:left;}tbody{display:table-row-group;}}@media screen{#pagelogo{display:none;}.iframe-table{border:none !important;}thead{}tfoot{display:none;}#watermark {display:none;color: #d0d0d0;font-size: 75pt;-webkit-transform: rotate(-45deg);-moz-transform: rotate(-45deg);transform: rotate(-45deg);position: fixed;width: 100%;height: 100%;margin: 0;z-index: 100;opacity: 0.6;left: 6%;top:25%;text-align: center;}} </style>');
        
						    window.document.body.appendChild(iframe);
							var iframeObj=document.getElementById(iframe.id);
							var iframeDoc=iframeObj.contentDocument;
							var basePath = window.location.search.substring(1).split('/OPS');
				data = data.replaceAll("../../", basePath[0]+"/OPS/");
							iframeDoc.open();
				iframeDoc.write(data);
				iframeDoc.close();

				setTimeout(function() {
          iframeObj.style.height = iframeObj.contentWindow.document.body.scrollHeight + 30+ 'px';
          $(iframe).contents().find('body').append('<div id="watermark"><p>Not for Distribution</p></div>');
          $(iframe).contents().find('body').find('[data-offlinesupport="no"]').each(function() {
            const fallback = $(this).find('.fallback');
            if (fallback.children().length > 0) {
              $(this).replaceWith(fallback.show());
            }
            else { 
              const getComputedStyle = popoutWindow.getComputedStyle(this, null);
              const computedHeight = getComputedStyle.getPropertyValue('height');
              const computedWidth = getComputedStyle.getPropertyValue('width');
              const contentHeight = (computedHeight === 'auto') ? $(this).attr('height'):computedHeight;
              const contentWidth = (computedWidth === 'auto') ? $(this).attr('width'):computedWidth;
              $(this).replaceWith('<div class="contentPlaceholder" > This content is unavailable when printing </div>').show();
            }
          });
        }, 2000);

						},
						error: function(xhr, status, err) {
							alert('Not able to load content')
						}
					});
}
</script>
</head>
<body onload="initPrint()">
<div>
 		<button type="button" onClick="window.print()">Print</button>
  		</div>
</body>
</html>
pdfAnnotatorInstance=function(){function a(){$("body").mousedown(function(a){F&&$(a.target).parents("#root").length&&0==$(a.target).parents("#openPopupHighlight").length&&$("#openPopupHighlight").is(":visible")&&g()}),$(document).on("keyup",function(a){27===a.keyCode&&$("#openPopupHighlight").is(":visible")&&g()})}function b(a,b,d,e,i,j,k,o){try{document.getElementById("openPopupHighlight").remove()}catch(a){}var q=$("#docViewer_ViewContainer").offset().left,r=$("#docViewer_ViewContainer").width();v=j,b.left=q+r-($(".fwr-page").offset().left+287),b.top=b.top+document.getElementsByClassName("eT1headerBar")[0].clientHeight-20;var w=document.createElement("div");w.setAttribute("id","openPopupHighlight"),w.style.left=b.left+"px",w.style.top=b.top+"px",w.style.width=b.width+"px",w.style.height=b.height+"px",w.style.position="absolute",w.innerHTML=A,document.getElementById(i).appendChild(w),B.saveHighlightCallback=d,B.editHighlightCallback=e,p=a,s=!1,t=!1,u=!0,F=!0,G=k,H=o,$("#color-button-yellow, #color-button-green, #color-button-pink").on("click",function(a){c(a)}),$("#note-text-area").on("input",function(a){m(a)}),$("#note-text-area").on("click",function(a){$("#note-text-area").focus()}),$("#deleteIcon").on("click",function(a){f(),document.getElementById("label-confirm").innerHTML=v.messages.confirm,document.getElementById("ann-confirm-cancel").innerHTML=v.messages.cancel,document.getElementById("ann-confirm-del").innerHTML=v.messages.delete}),$("#editIcon").on("click",function(a){h()}),$("#cancel-saving").on("click",function(a){g()}),$("#save-annotation").on("click",function(a){l(!1)}),$("#ann-share").on("click",function(a){n(a)}),$(".annotator-edit-container").hide(),D=$("#note-text-area")[0].scrollHeight||40,$(E).find(".annotator-share-text, .annotator-share").hide(),document.getElementById("note-text-area").placeholder=v.messages.writeNote,document.getElementById("cancel-saving").innerHTML=v.messages.cancel,document.getElementById("save-annotation").innerHTML=v.messages.save,document.getElementById("share-text").innerHTML=v.messages.share}function c(a){r=a.currentTarget.value;var b=a.currentTarget.id;if("color-button-pink"==b?q="pink":"color-button-green"==b?q="green":"color-button-yellow"==b&&(q="yellow"),$("#annotator-outer-id").hasClass("hide-note")?k():l(!0),$(".annotator-editor").removeClass("hide-note"),$(".annotator-color").removeClass("active"),$(a.target).addClass("active"),$(E).find(".annotator-listing .characters-left").remove(),$("#letter-count").text(3e3-$(E).find("textarea").val().length),u){var c=$("#annotator-outer-id").position().top+$("#annotator-outer-id").find("form").height()-$("#annotator-outer-id").find(".annotator-panel-1").height();$("#annotator-outer-id").css({top:c}),u=!1}d()}function d(){var a=$(".annotator-widget").offset().top,b=$(".annotator-widget").offset().left,c=$(".annotator-widget").height(),d=$(".annotator-widget").width(),e=$("#docViewer_ViewContainer_BG_0").offset().top,f=$("#docViewer_ViewContainer_BG_0").height();f+=e,a+c>f&&(a=f-c,$(".annotator-widget").offset({top:a,left:b}),$(".annotator-widget").width(d),$(".annotator-widget").height(c))}function e(){void 0!=B.deleteHighlightCallback&&B.deleteHighlightCallback(p.id),$(E).addClass(C.hide);var a=$(E).find(".annotator-panel-1"),b=$(E).find(".annotator-panel-2"),c=$(E).find(".annotator-panel-3"),d=$(E).find(".annotator-panel-4");a.removeClass("hide-popup"),b.removeClass("overlay"),c.removeClass("overlay"),d.remove(),$(E).addClass("hide-note"),F=!1}function f(){var a=$(E).find(".annotator-panel-1"),b=$(E).find(".annotator-panel-2"),c=$(E).find(".annotator-panel-3"),d=$(E).find(".annotator-panel-4");$(b).find("textarea").val().trim()?(a.addClass("hide-popup").after(z),d.addClass("annotator-panel-triangle"),b.addClass("overlay"),c.addClass("overlay"),$("#ann-confirm-cancel").on("click",function(a){i()}),$("#ann-confirm-del").on("click",function(a){e()})):e()}function g(){$(E).addClass(C.hide),$(E).addClass("hide-note").removeClass("show-edit-options"),$(".annotator-edit-container").show(),$(".annotator-panel-1").removeClass("disabled-save"),i()}function h(){$(E).addClass("show-edit-options"),$(E).find("textarea").show(),$(E).find("#noteContainer").hide(),$(E).find("textarea").css({"pointer-events":"all",opacity:"1"}),$(E).find("input").css({"pointer-events":"all",opacity:"1"}),$(E).find("textarea").val().length&&3==G&&-1!=H?$(E).find(".annotator-share-text, .annotator-share").show():$(E).find(".annotator-share-text, .annotator-share").hide(),t=!0}function i(){var a=$(E).find(".annotator-panel-1"),b=$(E).find(".annotator-panel-2"),c=$(E).find(".annotator-panel-3"),d=$(E).find(".annotator-panel-4");a.removeClass("hide-popup"),b.removeClass("overlay"),c.removeClass("overlay"),d.remove(),F=!1}function j(a){p=a}function k(){var a="",b={currHighlightColor:q,currHighlightColorCode:r,noteText:a,isShared:s};B.saveHighlightCallback(p,b)}function l(a){var b,c={};a?void 0!=q&&(c.currHighlightColor=q):(b=document.getElementById("note-text-area").value,c.currHighlightColor=q,c.isShared=s,c.noteText=b),B.editHighlightCallback(p.id,c),a||g()}function m(a){t?($(E).addClass("show-edit-options"),3==G&&-1!=H?$(E).find(".annotator-share-text, .annotator-share").show():$(E).find(".annotator-share-text, .annotator-share").hide()):(a.target.value.length?$(E).addClass("show-edit-options"):$(E).removeClass("show-edit-options"),3==G&&-1!=H&&a.target.value.length?$(E).find(".annotator-share-text, .annotator-share").show():$(E).find(".annotator-share-text, .annotator-share").hide())}function n(a){$(a.target).hasClass("on")?($(a.target).removeClass("on"),s=!1,$("#color-button-yellow").prop("disabled",!1),$("#color-button-green").prop("disabled",!1),$("#color-button-pink").prop("disabled",!1),$("#color-button-yellow").css({background:"#ffd232"}),$("#color-button-green").css({background:"#55df49"}),$("#color-button-pink").css({background:"#fc92cf"}),$("#color-button-"+q).addClass("active")):($(a.target).addClass("on"),s=!0,$("#color-button-yellow").prop("disabled",!0),$("#color-button-green").prop("disabled",!0),$("#color-button-pink").prop("disabled",!0),$("#color-button-yellow").css({background:"#fff1c1"}),$("#color-button-green").css({background:"#CCF5C8"}),$("#color-button-pink").css({background:"#FEDEF0"}),$(".annotator-color").removeClass("active"))}function o(a,b,e,i,j,k,o,v){var w=$("#"+a.id),x=w[0].children[0],y=j,z={left:x.offsetLeft,top:x.offsetTop,width:x.offsetWidth,height:x.offsetHeight};try{document.getElementById("openPopupHighlight").remove()}catch(a){}var I=$("#docViewer_ViewContainer").offset().left,J=$("#docViewer_ViewContainer").width();z.left=I+J-($(".fwr-page").offset().left+287),z.top=z.top+document.getElementsByClassName("eT1headerBar")[0].clientHeight-20,void 0!==o&&(z.top=o+document.getElementsByClassName("eT1headerBar")[0].clientHeight-20);var K=document.createElement("div");if(K.setAttribute("id","openPopupHighlight"),K.style.left=z.left+"px",K.style.top=z.top+"px",K.style.width=z.width+"px",K.style.height=z.height+"px",K.style.position="absolute",K.innerHTML=A,document.getElementById(i).appendChild(K),B.editHighlightCallback=b,B.deleteHighlightCallback=e,p=a,G=k,H=v,$("#color-button-yellow, #color-button-green, #color-button-pink").on("click",function(a){c(a)}),$("#note-text-area").on("input",function(a){m(a)}),$("#note-text-area").on("click",function(a){$("#note-text-area").focus()}),$("#deleteIcon").on("click",function(a){f(),document.getElementById("label-confirm").innerHTML=y.messages.confirm,document.getElementById("ann-confirm-cancel").innerHTML=y.messages.cancel,document.getElementById("ann-confirm-del").innerHTML=y.messages.delete}),$("#editIcon").on("click",function(a){h(),document.getElementById("cancel-saving").innerHTML=y.messages.cancel}),$("#cancel-saving").on("click",function(a){g()}),$("#save-annotation").on("click",function(a){l(!1)}),$("#ann-share").on("click",function(a){n(a)}),$(E).removeClass(C.hide),a.comment&&a.comment.length||$(".annotator-edit-container").hide(),a.color||a.shared){$(".annotator-editor").removeClass("hide-note");var L,M,N=$(E).find("textarea").prop("scrollHeight");M=$(E).find("textarea").height(),$(E).find("textarea").height(N),L=$(E).position().top,pos=N-M+L,$(E).css({top:pos})}s=a.shared,t=!1,a.shared?$(".annotator-share").addClass("on"):$(".annotator-share").removeClass("on"),$(".annotator-item input").length||$(".annotator-item").prepend('<div class="noteContainer" id = "noteContainer" style="height:100px;"></div>'),$(".annotator-color").removeClass("active"),a.shared||$("#color-button-"+a.color).addClass("active"),q=a.color,r=$("#color-button-"+a.color).val(),$(E).find(".annotator-save").addClass(C.focus),$(E).find(".annotator-listing .characters-left").remove(),$("#note-text-area").val(a.comment),$("#letter-count").text(3e3-$(E).find("textarea").val().length),D=$("#note-text-area")[0].scrollHeight||40,a.comment&&a.comment.length||($(E).find("textarea").css({"pointer-events":"all",opacity:"1"}),$(E).find("input").css({"pointer-events":"all",opacity:"1"})),$(E).find(":input:first").focus(),$(E).find("textarea").val().length>0?($($(E)).find("#noteContainer").html($(E).find("textarea").val()),$($(E).find("textarea")).hide(),$($(E)).find("#noteContainer").show()):($($(E).find("textarea")).show(),$($(E)).find("#noteContainer").hide());var O=$("#annotator-outer-id").position().top+$("#annotator-outer-id").find("form").height()-$("#annotator-outer-id").find(".annotator-panel-1").height();$("#annotator-outer-id").css({top:O}),u=!1,F=!0,document.getElementById("share-text").innerHTML=y.messages.share,document.getElementById("save-annotation").innerHTML=y.messages.save,d(),$(E).find(".annotator-share-text, .annotator-share").hide(),2==G&&a.shared?($(E).removeClass("show-edit-options"),$(E).find(".characters-left").css({visibility:"hidden"}),$("#color-button-yellow").prop("disabled",!0),$("#color-button-green").prop("disabled",!0),$("#color-button-pink").prop("disabled",!0),$("#color-button-yellow").css({background:"#fff1c1"}),$("#color-button-green").css({background:"#CCF5C8"}),$("#color-button-pink").css({background:"#FEDEF0"}),$(".annotator-edit-container").hide(),$(".annotator-delete-container").hide()):a.shared&&($("#color-button-yellow").prop("disabled",!0),$("#color-button-green").prop("disabled",!0),$("#color-button-pink").prop("disabled",!0),$("#color-button-yellow").css({background:"#fff1c1"}),$("#color-button-green").css({background:"#CCF5C8"}),$("#color-button-pink").css({background:"#FEDEF0"}))}var p,q,r,s,t,u,v,w='<div class="annotator-panel-1 annotator-panel-triangle"><div class="annotator-color-container"><input id="color-button-yellow" type="button" class="annotator-color annotator-yellow" value="#FFD232"/><input id="color-button-green" type="button" class="annotator-color annotator-green" value="#55DF49"/><input id="color-button-pink" type="button" class="annotator-color annotator-pink" value="#FC92CF"/></div><div id="deleteIcon" class="annotator-delete-container"></div><div id="editIcon" class="annotator-edit-container"></div></div>',x='<div class="annotator-panel-2"><ul class="annotator-listing"><li class="annotator-item"><textarea maxlength="3000" id="note-text-area" placeholder="Write a note." style="pointer-events: all; opacity: 1; max-height:75px; min-height:75px; resize:none"></textarea></li></ul></div>',y='<div class="annotator-panel-3"><div class="annotator-controls"><div class="ann-share-section"><label id="share-text" class="annotator-share-text">Share</label><div id="ann-share" class="annotator-share"></div></div><div class="ann-cancelsave-section"><a id="cancel-saving" class="annotator-cancel">CANCEL</a><a id="save-annotation" class="annotator-save annotator-focus">SAVE</a></div></div></div>',z='<div class="annotator-panel-4 annotator-panel-triangle"><div class="ann-confirm-section"><label id="label-confirm" class="annotator-confirm">Confirm?</label></div><div class="ann-canceldelete-section"><a id="ann-confirm-cancel" class="annotator-confirm-cancel">CANCEL</a><a id="ann-confirm-del" class="annotator-confirm-delete">DELETE</a></div></div></div>',A='<div id="annotator-outer-id" class="annotator-outer annotator-editor hide-note"><form id="highlight-note-form" class="annotator-widget">'+w+x+y+"</form></div>",B={},C={hide:"annotator-hide",focus:"annotator-focus"},D=null,E="#openPopupHighlight",F=!1,G=0,H=0;return{showCreateHighlightPopup:b,init:a,showSelectedHighlight:o,setCurrentHighlight:j}}();
pdfAnnotatorInstance=function(){function a(a,c,g,j){try{document.getElementById("openPopupHighlight").remove()}catch(a){}c.left=c.left+1.5*c.width,c.top=c.top+1.5*c.height;var l=document.createElement("div");l.setAttribute("id","openPopupHighlight"),l.style.left=c.left+"px",l.style.top=c.top+"px",l.style.width=c.width+"px",l.style.height=c.height+"px",l.style.position="absolute",l.innerHTML=s,document.getElementById(j).appendChild(l),t.saveHighlightCallback=g,k=a,$("#color-button-yellow, #color-button-green, #color-button-pink").on("click",function(a){b(a)}),$("#annotator-field-0").on("input",function(a){i(a)}),$("#deleteIcon").on("click",function(a){d()}),$("#editIcon").on("click",function(a){f()}),$("#cancel-saving").on("click",function(a){e()}),$("#save-annotation").on("click",function(a){h()})}function b(a){m=a.currentTarget.value;var b=a.currentTarget.id;"color-button-pink"==b?l="pink":"color-button-green"==b?l="green":"color-button-yellow"==b&&(l="yellow"),$(".annotator-editor").removeClass("hide-note"),$(".annotator-color").removeClass("active"),$(a.target).addClass("active"),$("#openPopupHighlight").find(".annotator-listing .characters-left").remove(),$("#openPopupHighlight").find(".annotator-listing").append(r),$("#letter-count").text(3e3-$("#openPopupHighlight").find("textarea").val().length)}function c(){void 0!=t.deleteHighlightCallback&&t.deleteHighlightCallback(k.id),$("#openPopupHighlight").addClass(u.hide);var a=$("#openPopupHighlight").find(".annotator-panel-1"),b=$("#openPopupHighlight").find(".annotator-panel-2"),c=$("#openPopupHighlight").find(".annotator-panel-3"),d=$("#openPopupHighlight").find(".annotator-panel-4");a.removeClass("hide-popup"),b.removeClass("overlay"),c.removeClass("overlay"),d.remove(),$("#openPopupHighlight").addClass("hide-note")}function d(){var a=$("#openPopupHighlight").find(".annotator-panel-1"),b=$("#openPopupHighlight").find(".annotator-panel-2"),d=$("#openPopupHighlight").find(".annotator-panel-3"),e=$("#openPopupHighlight").find(".annotator-panel-4");$(b).find("textarea").val().trim()?(a.addClass("hide-popup").after(q),e.addClass("annotator-panel-triangle"),b.addClass("overlay"),d.addClass("overlay"),$("#ann-confirm-cancel").on("click",function(a){g()}),$("#ann-confirm-del").on("click",function(a){c()})):c()}function e(){$("#openPopupHighlight").addClass(u.hide),$("#openPopupHighlight").addClass("hide-note").removeClass("show-edit-options"),$(".annotator-edit-container").show(),$(".annotator-panel-1").removeClass("disabled-save"),g()}function f(){$("#openPopupHighlight").addClass("show-edit-options"),$("#openPopupHighlight").find("textarea").show(),$("#openPopupHighlight").find("#noteContainer").hide(),$("#openPopupHighlight").find("textarea").css({"pointer-events":"all",opacity:"1"}),$("#openPopupHighlight").find("input").css({"pointer-events":"all",opacity:"1"})}function g(){var a=$("#openPopupHighlight").find(".annotator-panel-1"),b=$("#openPopupHighlight").find(".annotator-panel-2"),c=$("#openPopupHighlight").find(".annotator-panel-3"),d=$("#openPopupHighlight").find(".annotator-panel-4");a.removeClass("hide-popup"),b.removeClass("overlay"),c.removeClass("overlay"),d.remove()}function h(){var a=document.getElementById("annotator-field-0").value;const b={currHighlightColor:l,currHighlightColorCode:m,noteText:a};t.saveHighlightCallback(k,b),e()}function i(a){var b=3e3;$("#openPopupHighlight").addClass("show-edit-options"),a.target.value.length||$("#openPopupHighlight").find(".annotator-share-text, .annotator-share").hide();var c=a.currentTarget.value.length,d=b,e=d-c;$("#openPopupHighlight").find("#letter-count").text(e);var f=$("#openPopupHighlight").find(".annotator-item textarea"),g=v;if(v=$("#annotator-field-0")[0].scrollHeight,g!==v){f.height(v),v=$("#annotator-field-0")[0].scrollHeight;var h=$("#openPopupHighlight").position().top+(v-g);$("#openPopupHighlight").css({top:h})}}function j(a,c,g,j){var l=$("#"+a.id),m=l[0].firstChild;const n={left:m.offsetLeft,top:m.offsetTop,width:m.offsetWidth,height:m.offsetHeight};try{document.getElementById("openPopupHighlight").remove()}catch(a){}n.left=n.left+1.5*n.width,n.top=n.top+1.5*n.height;var o=document.createElement("div");if(o.setAttribute("id","openPopupHighlight"),o.style.left=n.left+"px",o.style.top=n.top+"px",o.style.width=n.width+"px",o.style.height=n.height+"px",o.style.position="absolute",o.innerHTML=s,document.getElementById(j).appendChild(o),t.editHighlightCallback=c,t.deleteHighlightCallback=g,k=a,$("#color-button-yellow, #color-button-green, #color-button-pink").on("click",function(a){b(a)}),$("#annotator-field-0").on("input",function(a){i(a)}),$("#deleteIcon").on("click",function(a){d()}),$("#editIcon").on("click",function(a){f()}),$("#cancel-saving").on("click",function(a){e()}),$("#save-annotation").on("click",function(a){h()}),a.shared=!0,$("#openPopupHighlight").removeClass(u.hide),a.note&&a.note.length||$(".annotator-edit-container").hide(),a.colour||a.shared){$(".annotator-editor").removeClass("hide-note");var p,q,w=$("#openPopupHighlight").find("textarea").prop("scrollHeight");q=$("#openPopupHighlight").find("textarea").height(),$("#openPopupHighlight").find("textarea").height(w),p=$("#openPopupHighlight").position().top,pos=w-q+p,$("#openPopupHighlight").css({top:pos})}$(".annotator-color").removeClass("active"),$("#color-button-"+a.colour).addClass("active"),$("#openPopupHighlight").find(".annotator-save").addClass(u.focus),$("#openPopupHighlight").find(".annotator-listing .characters-left").remove(),$("#openPopupHighlight").find(".annotator-listing").append(r),$("#annotator-field-0").val(a.note),$("#letter-count").text(3e3-$("#openPopupHighlight").find("textarea").val().length),v=$("#annotator-field-0")[0].scrollHeight||40,a.note&&a.note.length||($("#openPopupHighlight").find("textarea").css({"pointer-events":"all",opacity:"1"}),$("#openPopupHighlight").find("input").css({"pointer-events":"all",opacity:"1"})),$("#openPopupHighlight").find(":input:first").focus(),$($("#openPopupHighlight")).find("#noteContainer").html(linkifyStr($("#openPopupHighlight").find("textarea").val())),$($("#openPopupHighlight").find("textarea")).show(),$($("#openPopupHighlight")).find("#noteContainer").show()}var k,l,m,n='<div class="annotator-panel-1 annotator-panel-triangle"><div class="annotator-color-container"><input id="color-button-yellow" type="button" class="annotator-color annotator-yellow" value="#FFD232"/><input id="color-button-green" type="button" class="annotator-color annotator-green" value="#55DF49"/><input id="color-button-pink" type="button" class="annotator-color annotator-pink" value="#FC92CF"/></div><div id="deleteIcon" class="annotator-delete-container"></div><div id="editIcon" class="annotator-edit-container"></div></div>',o='<div class="annotator-panel-2"><ul class="annotator-listing"><li class="annotator-item"><textarea maxlength="3000" id="annotator-field-0" placeholder="Write a note." style="pointer-events: all; opacity: 1;"></textarea></li></ul></div>',p='<div class="annotator-panel-3"><div class="annotator-controls"><div class="ann-share-section"><label class="annotator-share-text">Share</label><div class="annotator-share"></div></div><div class="ann-cancelsave-section"><a id="cancel-saving" class="annotator-cancel">CANCEL</a><a id="save-annotation" class="annotator-save annotator-focus">SAVE</a></div></div></div>',q='<div class="annotator-panel-4 annotator-panel-triangle"><div class="ann-confirm-section"><label class="annotator-confirm">Confirm?</label></div><div class="ann-canceldelete-section"><a id="ann-confirm-cancel" class="annotator-confirm-cancel">CANCEL</a><a id="ann-confirm-del" class="annotator-confirm-delete">DELETE</a></div></div></div>',r='<li class="characters-left"><span id="letter-count">3000</span id="letter-text">  Characters left<span><span></li>',s='<div class="annotator-outer annotator-editor hide-note"><form class="annotator-widget">'+n+o+p+"</form></div>",t={},u={hide:"annotator-hide",focus:"annotator-focus"},v=null;return{showCreateHighlightPopup:a,hide:e,showSelectedHighlight:j}}();